<% layout('layouts/boilerplate') -%>
<link rel="stylesheet" href="/css/stars.css" />
<div class="container">
	<div class="row">
		<div class="col-md-6">
			<div class="card mt-3">
				<img src="<%= campground.image %>" alt="camp image" class="card-img-top" />
				<div class="card-body">
					<div class="">
						<h5 class="card-title"><%= campground.title %></h5>
					</div>
					<h6 class="card-subtitle mb-2 text-muted"><%= campground.location %></h6>
					<div class="btn btn-sm btn-outline-info mb-2">
						<strong>&dollar; <%= campground.price %></strong>/night
					</div>
					<p class="card-text"><%= campground.description %></p>
					<% if (currentUser && campground.author.equals(currentUser._id)) { %>
					<div class="py-3 row justify-content-start">
						<div class="col-auto text-center">
							<a href="/campgrounds/<%= campground._id %>/update ">
								<input type="submit" value="Update" class="btn btn-warning" />
							</a>
						</div>
						<div class="col-auto text-center">
							<form
								action="/campgrounds/<%= campground._id %>?_method=DELETE"
								method="post"
							>
								<button type="submit" class="btn btn-danger">Delete</button>
							</form>
						</div>
					</div>
					<% } %>
				</div>
				<div class="card-footer bg-none">
					Submitted by - <%= campground.author.username %>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<h2 class="mt-3">Leave A Review</h2>
			<form
				action="/campgrounds/<%=campground._id%>/reviews"
				method="post"
				class="border rounded-3 p-3 mb-3 validation-form reviewForm"
				novalidate
			>
				<div>
					<label for="rating" class="form-label">Rating</label>
					<fieldset class="starability-basic">
						<input type="radio" id="first-rate1" name="review[rating]" value="1" />
						<label for="first-rate1" title="Terrible">1 star</label>
						<input type="radio" id="first-rate2" name="review[rating]" value="2" />
						<label for="first-rate2" title="Not good">2 stars</label>
						<input type="radio" id="first-rate3" name="review[rating]" value="3" checked/>
						<label for="first-rate3" title="Average">3 stars</label>
						<input type="radio" id="first-rate4" name="review[rating]" value="4" />
						<label for="first-rate4" title="Very good">4 stars</label>
						<input type="radio" id="first-rate5" name="review[rating]" value="5" />
						<label for="first-rate5" title="Amazing">5 stars</label>
					  </fieldset>
					<div class="invalid-feedback">This is a required field !</div>
				</div>
				<div class="mb-3">
					<label for="body" class="form-label">Review</label>
					<textarea
						name="review[body]"
						class="form-control"
						id="body"
						rows="3"
						required
					></textarea>
					<div class="invalid-feedback">This is a required field !</div>
				</div>
				<% if (!currentUser) { %>
				<button disabled="disabled" class="btn btn-success">Submit</button>
				<span class="fst-italic text-black-50 me-2"
					>You need to be logged in to leave a review</span
				>
				<% } else { %>
				<button class="btn btn-success">Submit</button>
				<% } %>
			</form>
			<section>
				<% for( let review of campground.reviews) { %>
				<div class="card mb-3">
					<div class="card-body">
						<p class="starability-result" data-rating=<%= review.rating %>></p>
						<h5 class="card-title"> - <%= review.author.username %></h5>
						<p class="card-text">Review - <%= review.body %></p>
						<% if (currentUser && review.author.equals(currentUser._id)) { %>
						<div class="d-flex justify-content-start">
							<form
								action="/campgrounds/<%= campground._id %>/reviews/<%= review._id %>?_method=DELETE"
								method="post"
							>
								<button class="btn btn-sm btn-danger">
									<svg
										xmlns="http://www.w3.org/2000/svg"
										width="16"
										height="16"
										fill="currentColor"
										class="bi bi-trash3-fill"
										viewBox="0 0 16 16"
									>
										<path
											d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"
										/>
									</svg>
								</button>
							</form>
						</div>
						<% } %>
					</div>
				</div>

				<% } %>
			</section>
		</div>
	</div>
</div>
<a href="/campgrounds">Back to Main Page</a>
